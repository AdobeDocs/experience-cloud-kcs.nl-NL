---
title: Hoe te om SAML verwante kwesties in AEM problemen op te lossen
description: Beschrijving
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Roxann McGlumphy
article-created-date: 10/21/2021 5:02:47 PM
article-published-by: Cedric Latimier
article-published-date: 1/18/2022 2:33:40 PM
version-number: 1
article-number: KA-17476
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=55a54eb6-9032-ec11-b6e5-000d3a5ba97a
exl-id: f7cf029d-bc42-4180-8746-63b012b7e9ff
source-git-commit: 0c3e421beca46d9fe1952b1f98538a50697216a0
workflow-type: tm+mt
source-wordcount: '411'
ht-degree: 1%

---

# Hoe te om SAML verwante kwesties in AEM problemen op te lossen

## Beschrijving

Hoe kunnen wij de verwante kwesties van SAML met AEM problemen oplossen? Welke informatie wordt vereist om problemen op te lossen?

## Resolutie


<b>Oneindige lus:</b>

- Controleren of `ds:signature` maakt deel uit van SAML bewering als niet, dit moet op het eind van IDP worden gedaan en checkbox voor ondertekende Bevestiging controleren
- Controle voor nameId formaat in de reactie van SAML, zou het formaat het nameId- Beleid formaat zoals die in SAML Config wordt gevormd precies moeten aanpassen
- Controle voor SAML AudienceRestriction in reactie SAML, de waarde van deze markering zou de entiteitidentiteitskaart in SAML config precies moeten aanpassen
- Controleren op `saml2:conditions(NotBefore & NotOnOrAfter)`, Server is niet synchroon met ntp-server.Gebruik ntpd en forceer deze om de tijd van het systeem te synchroniseren (`ntpdate -s pool.ntp.org`). Voor test, verander de kloktolerantie in -1, zal dit klokverschil negeren.
- Controleer of IDP geen bevestiging heeft ondertekend. Vraag het IDP-team dat de reactie is ondertekend en dat de bevestiging moet worden ondertekend volgens de SAML-specificatie.
- Controleer of de SAML-traceringsuitvoer is gecodeerd als de bewering van IDP is gecodeerd. Indien ja, zou Config van SAML de autethandler versleutelingscheckbox moeten gebruiken


<b>Controleer of het SAML-certificaat de juiste indeling heeft:</b>

- Vestig de handtekening van het antwoord van SAML en verbeter het certificaat, d.w.z. na 65th lijn, druk binnengaan etc.
- Dit kan dan worden gebruikt om in AEM truststore te installeren en certificaatdetails met IDP aan te passen.


<b>Codering:</b>

- Eerst moet SAML altijd zonder codering worden ingesteld. Schakel codering in wanneer dit gebeurt. Op deze manier kunt u gemakkelijk fouten opsporen in het probleem


<b>Dispatcher:</b>

- Zorg ervoor dat de SAML-aanmeldaanvraag is toegestaan in de filtersectie. Als dit niet het geval is, werkt u de `/filter` sectie om verzoeken van POSTEN toe te staan aan `\*/saml_login`.



   `/0100 { /type "allow" /method "POST" /url "\*/saml_login" }`


- Controleren op wijziging in `Mod` header()`mod_header`) op het niveau van de webserver in `httpd.conf`.De indeling moet onder zijn

   `Header always edit Set-Cookie (.\*) "$1; HTTPOnly; Secure"`


<b>Ongeldige bevestiging:</b>
<br><br><br><br><br> <br><br> <br><br><br><br>

| 1<br>  2 | `com.adobe.granite.auth.saml.model.Assertion Invalid Assertion: Signature invalid.` `com.adobe.granite.auth.saml.SamlAuthenticationHandler Private key of SP not provided: Cannot sign Authn request` |
| --- | --- |


- De kwestie zou met certificaat kunnen zijn dat in het truststore wordt opgeslagen. De oplossing kan hier zijn om de nieuwe `idp_cert` en controleer het geval.
- Als u niet de reactie van SAML in het leven roept, kunt u &quot;Persoonlijke sleutel van SP negeren niet verstrekte: Fout: kan ontwerpverzoek niet ondertekenen.&quot;


<b>Kan persoonlijke sleutel niet ophalen:</b>
<br><br><br><br><br> <br><br> <br><br><br><br>

| 1<br>  2 | `com.adobe.granite.security.user.internal.servlets.KeyStoreManagingServlet,1121, javax.servlet.Servlet ServiceEvent REGISTERED` `saml.log:27.01.2019 14:16:13.642 *ERROR* qtp275633701-179 com.adobe.granite.auth.saml.SamlAuthenticationHandler KeyStore uninitialized. Cannot retrieve private key to decrypt assertions.` |
| --- | --- |

 
- Deze fout betekent dat IDP de bewering heeft gecodeerd en dat er geen persoonlijke sleutel is om de reactie te decoderen. Als u de reactie wilt coderen, moet u een geldige persoonlijke sleutel uploaden in het AEM sleutelarchief.

<br><br><br><br> <br><br>
<b>Informatie die moet worden verstrekt wanneer het opheffen van een SAML-gerelateerd ondersteuningsticket:</b>

- SAML-verzoek
- SAML-respons
- SAML-configuratie
- FOUTOPSPORINGSlogs voor SAML (`com.adobe.granite.auth.saml`)
- `Error.log`
- HAR1-bestand om SAML-verzoek/reactie te extraheren


1https://help.tenderapp.com/kb/troubleshooting-your-tender-site/generating-an-har-file
