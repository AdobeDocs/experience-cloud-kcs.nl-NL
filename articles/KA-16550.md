---
title: "Hoe te om een datastore consistentiecontrole via eiken-looppas in werking te stellen"
description: Beschrijving
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/How-to-run-a-datastore-consistency-check-via-oak-run-AEM.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 10:17:22 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 10:19:33 PM"
version-number: 3
article-number: KA-16550
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=60cb4e8b-6e87-eb11-a812-000d3a593216"
exl-id: 5194c5b2-28ad-483f-9bee-85ce25d78f36
source-git-commit: a59847e2e7e37f432cb01150b9444cd9dbf585df
workflow-type: tm+mt
source-wordcount: '316'
ht-degree: 1%

---

# Hoe te om een datastore consistentiecontrole via eiken-looppas in werking te stellen

## Beschrijving

Het gereedschap voor het uitvoeren van een eik is handig wanneer u een fout als deze constateert:

```
09.11.2017 13:42:17.512 *WARN* async-index-update-async org.apache.jackrabbit.oak.plugins.blob.datastore.DataStoreBlobStore Error occurred while loading bytes from steam while fetching for id 4089b47c7ba7ab8015859428e7e6965eec4641e3#241
java.util.concurrent.ExecutionException: java.io.IOException: org.apache.jackrabbit.core.data.DataStoreException: Record 4089b47c7ba7ab8015859428e7e6965eec4641e3 does not exist
Caused by: java.io.IOException: org.apache.jackrabbit.core.data.DataStoreException: Record 4089b47c7ba7ab8015859428e7e6965eec4641e3 does not exist
```

In tegenstelling tot `/system/console/repositorycheck` UI, controleert het eiken in werking gestelde hulpmiddel de verborgen dossiers van de luceenindex onder `/oak`: index naast de rest van de inhoudspaden. Met dit gereedschap kunt u indexbestanden terugzetten naar de datastore of alleen de indexen die beschadigd zijn, opnieuw genereren in plaats van ze allemaal opnieuw te indexeren zoals is beschreven [hier](https://helpx.adobe.com/experience-manager/kb/oak-blobstore-inconsistency-blobId.html).

<b>Omgeving</b>

AEM 6.4 / Eak 1.8.8 en latere versies

## Resolutie

1. [JavaScript 1.8.8 of hoger downloaden](https://repo1.maven.org/maven2/org/apache/jackrabbit/oak-run/1.6.6/oak-run-1.6.6.jar) naar uw AEM.
1. Voer de onderstaande opdracht uit (maar verander de paden naar de segmentstore en de datastore om deze aan te passen aan uw omgeving):

   ```
   java -jar oak-run-*.jar datastorecheck --consistency --ref --id --fds crx-quickstart/install/org.apache.jackrabbit.oak.plugins.blob.datastore.FileDataStore.config --repoHome crx-quickstart/repository --store crx-quickstart/repository/segmentstore --dump temp --verbose --track
   ```

1. Het bevel zou een datastore consistentiecontrole uitvoeren.

1. Volg de uitvoer [het artikel](https://helpx.adobe.com/experience-manager/kb/oak-blobstore-inconsistency-blobId.html) om ontbrekende bestanden te herstellen of te herstellen.

De controle van de consistentie voor DataStore kan ook worden gebruikt om van alle blob verwijzingen in de knoopopslag en alle blob ids een lijst te maken beschikbaar in de gegevensopslag. Gebruik de volgende opdracht:

```
$ java-jar oak-run-*.jar datastorecheck --id --ref --consistency \
--store | \
--s3ds |--fds \
--dump \
--track
```

Geef een of meer van de volgende opties op:

- `--id` - Geef een lijst weer met alle id&#39;s in de gegevensopslag.
- `--ref` - Maak een lijst van alle blob verwijzingen in de knoopopslag.
- `--consistency` - Alle ontbrekende klodders weergeven door een consistentiecontrole uit te voeren.

De volgende opties zijn optioneel:

- `--store` - Pad naar de segmentopslag van mongouri (vereist voor `--ref` en `--consistency` hierboven).
- `--dump` - Pad waar de bestanden moeten worden gestort (optioneel). Anders worden bestanden gedumpt in de tmp-directory van de gebruiker.
- `--s3ds` - Pad naar het configuratiebestand S3DataStore.
- `--fds` - Pad naar het configuratiebestand FileDataStore (eigenschap &#39;path&#39; is verplicht).
- `--track` - Pad van de thuismap van de lokale opslagruimte (optioneel). Er wordt een kopie geplaatst van de gedownloade blob-id die moet worden bijgehouden.

<b>Wellicht ook interessant</b>

[Controle van Eak-gegevensopslag](https://github.com/apache/jackrabbit-oak/tree/1.8/oak-run#oak-datastore-check)
