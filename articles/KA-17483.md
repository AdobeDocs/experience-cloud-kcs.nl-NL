---
title: "Alleen-lezen of Onveranderbare bestanden in AEM"
description: "Leer hoe u werkt met bestanden die in AEM zijn gemarkeerd als alleen-lezen en onveranderlijk."
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, alleen-lezen, onveranderlijke bestanden, AEM, "
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Utkarsh Jha
article-created-date: "6/18/2024 11:30:17 AM"
article-published-by: Utkarsh Jha
article-published-date: "6/18/2024 11:46:29 AM"
version-number: 9
article-number: KA-17483
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=12f02d1e-662d-ef11-840a-00224809e160"
source-git-commit: 5cf19cb4138dc8e7a712ba06aa4a6fb22235cc57
workflow-type: tm+mt
source-wordcount: '793'
ht-degree: 0%

---

# Alleen-lezen of Immuable Files in AEM


In dit document wordt beschreven in welke bestanden vergrendeld en niet gewijzigd moeten worden en hoe u de gewenste configuratie-instellingen correct kunt maken in Adobe Experience Manager.

## Beschrijving {#description}


### Omgeving

Experience Manager

### Probleem/symptomen

Wanneer de Adobe Managed Services (AMS) een systeem verstrekt, ontwikkelen zij een basislijnconfiguratie die alles functioneel en veilig maakt. Dit zijn dingen die de AMS als basislijn van functionaliteit en veiligheid wil verzekeren. Hiertoe worden sommige bestanden gemarkeerd als alleen-lezen en onveranderlijk om te voorkomen dat u ze wijzigt.

De lay-out verhindert u niet hun gedrag te veranderen en om het even welke veranderingen te schrappen u wenst. Bedek in plaats van deze bestanden te wijzigen uw eigen bestand dat het origineel vervangt.

Op deze manier kunt u er zeker van zijn dat wanneer AMS de Dispatcher patches met de meest recente correcties en beveiligingsverbeteringen patcheert, deze uw bestanden niet zullen wijzigen.  Dan kunt u blijven profiteren van de verbeteringen en slechts de veranderingen goedkeuren u zou willen.

Zoals uit bovenstaande afbeelding blijkt, blokkeren onveranderlijke bestanden je niet om de game te spelen.  Ze houden je er gewoon van om je prestatiekracht te schaden en je in de rij te houden.  Met deze methode kunnen we de weinige sleutelfuncties gebruiken:

- Aanpassingen worden verwerkt in hun eigen veilige ruimten
- De bedekking van aangepaste wijzigingen weerspiegelt de bedekkingsmethoden in AEM
- De patchconfiguraties van AMS kunnen worden gedaan zonder aanpassingen te veranderen
- De testbasis installeert versus aangepaste configuraties kunnen gelijktijdig worden gedaan helpen als de kwesties door aanpassingen of iets anders worden veroorzaakt Welke Dossiers ontdekken?


Hier volgt een typische lijst van dossiers die met een Verzender worden opgesteld:


```
/etc/httpd/
├── conf
│   └── httpd.conf
├── conf.d
│   ├── available_vhosts
│   │   ├── 000_unhealthy_author.vhost
│   │   ├── 000_unhealthy_publish.vhost
│   │   ├── aem_author.vhost
│   │   ├── aem_flush.vhost
│   │   ├── aem_health.vhost
│   │   ├── aem_lc.vhost
│   │   └── aem_publish.vhost
│   ├── dispatcher_vhost.conf
│   ├── enabled_vhosts
│   │   ├── aem_author.vhost -> /etc/httpd/conf.d/available_vhosts/aem_author.vhost
│   │   ├── aem_flush.vhost -> /etc/httpd/conf.d/available_vhosts/aem_flush.vhost
│   │   ├── aem_health.vhost -> /etc/httpd/conf.d/available_vhosts/aem_health.vhost
│   │   └── aem_publish.vhost -> /etc/httpd/conf.d/available_vhosts/aem_publish.vhost
│   ├── logformat.conf
│   ├── remoteip.conf
│   ├── rewrites
│   │   ├── base_rewrite.rules
│   │   └── xforwarded_forcessl_rewrite.rules
│   ├── security.conf
│   ├── variables
│   │   └── ams_default.vars
│   └── whitelists
│       └── 000_base_whitelist.rules
├── conf.dispatcher.d
│   ├── available_farms
│   │   ├── 000_ams_author_farm.any
│   │   ├── 001_ams_lc_farm.any
│   │   └── 999_ams_publish_farm.any
│   ├── cache
│   │   ├── ams_author_cache.any
│   │   ├── ams_author_invalidate_allowed.any
│   │   ├── ams_publish_cache.any
│   │   └── ams_publish_invalidate_allowed.any
│   ├── clientheaders
│   │   ├── ams_author_clientheaders.any
│   │   ├── ams_common_clientheaders.any
│   │   ├── ams_lc_clientheaders.any
│   │   └── ams_publish_clientheaders.any
│   ├── dispatcher.any
│   ├── enabled_farms
│   │   ├── 000_ams_author_farm.any -> /etc/httpd/conf.dispatcher.d/available_farms/000_ams_author_farm.any

│   │   └── 999_ams_publish_farm.any -> /etc/httpd/conf.dispatcher.d/available_farms/999_ams_publish_farm.any
│   ├── filters
│   │   ├── ams_author_filters.any
│   │   ├── ams_lc_filters.any
│   │   └── ams_publish_filters.any
│   ├── renders
│   │   ├── ams_author_renders.any
│   │   ├── ams_lc_renders.any
│   │   └── ams_publish_renders.any
│   └── vhosts
│       ├── ams_author_vhosts.any
│       ├── ams_lc_vhosts.any
│       └── ams_publish_vhosts.any
├── conf.modules.d
│   ├── 01-cgi.conf
│   └── 02-dispatcher.conf
└── modules -> ../../usr/lib64/httpd/modules
    └── mod_dispatcher.so
```


Om te bepalen welke dossiers onveranderlijk zijn kunt u het volgende bevel op een Verzender in werking stellen om te zien:

`$ lsattr -Rl /etc/httpd 2 > /dev/null | grep Immutable`

Hier volgt een voorbeeldreactie waarvan bestanden onveranderlijk zijn:


```
/etc/httpd/conf/httpd.conf   Immutable
/etc/httpd/conf.d/available_vhosts/aem_author.vhost Immutable
/etc/httpd/conf.d/available_vhosts/aem_publish.vhost Immutable
/etc/httpd/conf.d/available_vhosts/aem_lc.vhost Immutable
/etc/httpd/conf.d/available_vhosts/aem_flush.vhost Immutable
/etc/httpd/conf.d/available_vhosts/aem_health.vhost Immutable
/etc/httpd/conf.d/available_vhosts/000_unhealthy_author.vhost Immutable
/etc/httpd/conf.d/available_vhosts/000_unhealthy_publish.vhost Immutable
/etc/httpd/conf.d/rewrites/base_rewrite.rules Immutable
/etc/httpd/conf.d/rewrites/xforwarded_forcessl_rewrite.rules Immutable
/etc/httpd/conf.d/whitelists/000_base_whitelist.rules Immutable
/etc/httpd/conf.d/dispatcher_vhost.conf Immutable
/etc/httpd/conf.d/logformat.conf Immutable
/etc/httpd/conf.d/security.conf Immutable
/etc/httpd/conf.modules.d/02-dispatcher.conf Immutable
/etc/httpd/conf.dispatcher.d/available_farms/000_ams_author_farm.any Immutable
/etc/httpd/conf.dispatcher.d/available_farms/999_ams_publish_farm.any Immutable
/etc/httpd/conf.dispatcher.d/available_farms/001_ams_lc_farm.any Immutable
/etc/httpd/conf.dispatcher.d/cache/ams_author_cache.any Immutable
/etc/httpd/conf.dispatcher.d/cache/ams_author_invalidate_allowed.any Immutable
/etc/httpd/conf.dispatcher.d/cache/ams_publish_cache.any Immutable
/etc/httpd/conf.dispatcher.d/cache/ams_publish_invalidate_allowed.any Immutable
/etc/httpd/conf.dispatcher.d/clientheaders/ams_author_clientheaders.any Immutable
/etc/httpd/conf.dispatcher.d/clientheaders/ams_publish_clientheaders.any Immutable
/etc/httpd/conf.dispatcher.d/clientheaders/ams_common_clientheaders.any Immutable
/etc/httpd/conf.dispatcher.d/clientheaders/ams_lc_clientheaders.any Immutable
/etc/httpd/conf.dispatcher.d/filters/ams_author_filters.any Immutable
/etc/httpd/conf.dispatcher.d/filters/ams_publish_filters.any Immutable
/etc/httpd/conf.dispatcher.d/filters/ams_lc_filters.any Immutable
/etc/httpd/conf.dispatcher.d/renders/ams_author_renders.any Immutable
/etc/httpd/conf.dispatcher.d/renders/ams_publish_renders.any Immutable
/etc/httpd/conf.dispatcher.d/renders/ams_lc_renders.any Immutable
/etc/httpd/conf.dispatcher.d/vhosts/ams_author_vhosts.any Immutable
/etc/httpd/conf.dispatcher.d/vhosts/ams_publish_vhosts.any Immutable
/etc/httpd/conf.dispatcher.d/vhosts/ams_lc_vhosts.any Immutable
/etc/httpd/conf.dispatcher.d/dispatcher.any Immutable
```



## Resolutie {#resolution}


### Hoe kan ik wijzigingen aanbrengen?

#### Variabelen

Met variabelen kunt u functionele wijzigingen doorvoeren zonder de configuratiebestanden zelf te wijzigen. Bepaalde elementen van de configuratie kunnen worden aangepast door de waarden van variabelen aan te passen. Een voorbeeld dat uit het bestand is gemarkeerd `/etc/httpd/conf.d/dispatcher_vhost.conf` wordt hier getoond:


```
Include /etc/httpd/conf.d/variables/ams_default.vars
<IfModule disp_apache2.c>
    DispatcherConfig conf.dispatcher.d/dispatcher.any
    DispatcherLog    logs/dispatcher.log
    DispatcherLogLevel ${DISP_LOG_LEVEL}
    DispatcherDeclineRoot 0
    DispatcherUseProcessedURL 1
</IfModule>
```


Zie hoe de `DispatcherLogLevel` richtlijn heeft een variabele `DISP_LOG_LEVEL` in plaats van de normale waarde zou je daar zien. Boven die sectie van code zult u ook een omvat verklaring aan een veranderingendossier zien. Het variabelenbestand `/etc/httpd/conf.d/variables/ams_default.vars` Dit is waar u het volgende wilt zien. Hier volgt de inhoud van het variabelenbestand:


```
Define DISP_LOG_LEVEL info
Define AUTHOR_WHITELIST_ENABLED 0
Define PUBLISH_WHITELIST_ENABLED 0
Define LIVECYCLE_WHITELIST_ENABLED 0
Define AUTHOR_FORCE_SSL 1
Define PUBLISH_FORCE_SSL 0
Define LIVECYCLE_FORCE_SSL 1
```


Hierboven ziet u de huidige waarde van `DISP_LOG_LEVEL` variable is &#39;info&#39;. U kunt dit aan spoor aanpassen of zuiveren, of de aantalwaarde/het niveau van uw keus. Nu, overal die het logboekniveau controleert automatisch aanpast.

#### Bedekkingsmethode

Houd rekening met de include-bestanden op hoofdniveau, omdat dit de beginplaats is voor het maken van aanpassingen. Om met een eenvoudig voorbeeld te beginnen, hebt u een scenario waar u een nieuwe domeinnaam wilt toevoegen die bedoeld is om bij deze Dispatcher te richten. Het domeinvoorbeeld dat we moeten gebruiken is `we-retail.adobe.com.` Begin door een bestaand configuratiedossier aan nieuw te kopiëren waar wij onze veranderingen kunnen toevoegen:


```
$ cp /etc/httpd/conf.d/available_vhosts/aem_publish.vhost /etc/httpd/conf.d/available_vhosts/weretail_publish.vhost
```


U hebt de bestaande `aem_publish.vhost` bestand omdat het al bevat wat je nodig hebt om dingen te laten werken en je geen al sterke start opnieuw wilt uitvinden.  Nu bewerkt u het nieuwe bestand weretail.vhost en brengt u de benodigde wijzigingen aan.

<u>Voor:</u>


```
<VirtualHost *:80>
    ServerName    publish
    ServerAlias    ${PUBLISH_DEFAULT_HOSTNAME}
    DocumentRoot    ${PUBLISH_DOCROOT}
    <IfModule mod_headers.c>
            Header always add X-Dispatcher ${DISP_ID}
            Header always add X-Vhost "publish"
            Header merge X-Frame-Options SAMEORIGIN "expr=%{resp:X-Frame-Options}!='SAMEORIGIN'"
            Header merge X-Content-Type-Options nosniff "expr=%{resp:X-Content-Type-Options}!='nosniff'"
        Header append Vary User-Agent env=!dont-vary
    </IfModule>
....... SNIP.......
</VirtualHost>
```


<u>Na:</u>


```
<VirtualHost *:80>
    ServerName    weretail-publish
    ServerAlias    we-retail.adobe.com
    DocumentRoot    ${PUBLISH_DOCROOT}
    <IfModule mod_headers.c>
            Header always add X-Dispatcher ${DISP_ID}
            Header always add X-Vhost "werteail-publish"
            Header merge X-Frame-Options SAMEORIGIN "expr=%{resp:X-Frame-Options}!='SAMEORIGIN'"
            Header merge X-Content-Type-Options nosniff "expr=%{resp:X-Content-Type-Options}!='nosniff'"
        Header append Vary User-Agent env=!dont-vary
    </IfModule>
....... SNIP.......
</VirtualHost>
```


Nu hebt u onze ServerName en ServerAlias bijgewerkt om de nieuwe domeinnamen aan te passen, evenals het bijwerken van andere broodkruimelkopballen.  Laten we nu het nieuwe bestand inschakelen zodat Apache weet dat het ons nieuwe bestand gebruikt:


```
$ cd /etc/httpd/conf.d/enabled_vhosts/; ln -s ../available_vhosts/weretail_publish.vhost .
```


Nu weet Apache-webserver dat een domein iets is waarvoor het verkeer moet worden opgewekt, maar u moet de module Dispatcher er nog steeds van op de hoogte stellen dat het een nieuwe domeinnaam heeft om te respecteren.  Maak eerst een nieuw bestand \*_vhost.any./etc/httpd/conf.dispatcher.d/vhosts/weretail_vhosts.any en sla het bestand op in de domeinnaam die u wilt respecteren:


```
"we-retail.adobe.com"
```


Nu, moet u een nieuw landbouwbedrijfdossier maken dat ons nieuwe dossier van de gastheeringang gebruikt, en u zult beginnen door een sterk begindossier aan onze eigen nieuwe te kopiëren.


```
$ cp /etc/httpd/conf.dispatcher.d/available_farms/999_ams_publish_farm.any /etc/httpd/conf.dispatcher.d/available_farms/400_weretail_publish_farm.any
```


Laat de veranderingen tonen u aan dit landbouwbedrijfdossier zult moeten aanbrengen

<u>Voor:</u>


```
/publishfarm {  
    /virtualhosts {
        $include "/etc/httpd/conf.dispatcher.d/vhosts/ams_publish_vhosts.any"
    }
........SNIP.........
}
```


<u>Na:</u>


```
/weretailpublishfarm {  
    /virtualhosts {
        $include "/etc/httpd/conf.dispatcher.d/vhosts/weretail_publish_vhosts.any"
    }
........SNIP.........
}
```


Nu hebt u de landbouwbedrijfnaam bijgewerkt, en omvat het gebruikt in de /virtualhosts sectie van de landbouwbedrijfconfiguratie. U moet dit nieuwe landbouwbedrijfdossier toelaten zodat kan het het in de lopende configuratie gebruiken:


```
$ cd /etc/httpd/conf.dispatcher.d/enabled_farms/; ln -s ../available_farms/400_weretail_publish_farm.any .
```


Nu hoeft u alleen maar de webserverservice opnieuw te laden en ons nieuwe domein te gebruiken.

<b>Opmerking:</b>

U hebt alleen de onderdelen gewijzigd die u nodig hebt om de bestaande include-bestanden en code die bij de basislijnconfiguratiebestanden zijn geleverd, te wijzigen en er gebruik van te maken.  U hoeft alleen het element te definiëren dat u wilt wijzigen.  Maakt het veel makkelijker en maakt het ons mogelijk minder code te handhaven
