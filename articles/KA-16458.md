---
title: "AEM Thread Dump Analysis"
description: Beschrijving
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html"
bug: false
article-created-by: Emily Geary
article-created-date: "3/17/2021 9:11:03 PM"
article-published-by: Emily Geary
article-published-date: "3/17/2021 9:13:37 PM"
version-number: 2
article-number: KA-16458
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=e70a8345-6587-eb11-a812-000d3a593216"
exl-id: 74bb70e4-a09b-48fc-8378-96a1736e5ebf
source-git-commit: a59847e2e7e37f432cb01150b9444cd9dbf585df
workflow-type: tm+mt
source-wordcount: '1000'
ht-degree: 0%

---

# Analyse van de  threads

## Beschrijving

AEM analyseren [!DNL Java] schroefdraad [IBM Thread Analyzer](http://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) gebruiken.

## Resolutie

1. Downloaden en installeren [IBM Thread Analyzer](https://www.ibm.com/developerworks/community/groups/service/html/communityview?communityUuid=2245aa39-fa5c-4475-b891-14c205f7333c) (We noemen het IBM TDA voor kort)
1. Vastleggen [schroefdraad](https://helpx.adobe.com/experience-manager/kb/TakeThreadDump.html) van een AEM instantie die prestatieproblemen ondervindt.
1. Open de thread dumps in IBM TDA.
1. Als u de details van een thread-dump wilt weergeven, selecteert u het bestand in de lijst en klikt u op de knop Details thread\*.

![tda-threaddetail](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1587732783/tda-threaddetail.png "tda-threaddetail")

1. Sorteer op &quot;Stapeldiepte&quot; met de langste stapels bovenaan.

   ![tda-image1](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image/tda-image1.png)

1. Bekijk de threads met een stapeldiepte van 10 lijnen of langer.  Dat zijn meestal de draden van het grootste belang.  Neem nota van draden die van belang zijn.
1. Sorteren op thread &quot;State&quot;
1. Schuif omlaag naar de &quot;Runnable&quot; threads. De in werking stellen draden zijn degenen die actief de tijd van cpu gebruikten toen de draadstortplaats werd genomen.

   *Opmerking: Wanneer het herzien van de &quot;Runnable&quot;draden, kunt u draden negeren die in [Threads die kunnen worden genegeerd](https://helpx.adobe.com/experience-manager/kb/thread-dump-analysis.html#ignorethreads) onder aan deze pagina.*

1. Zoek uitvoerbare threads die deel uitmaken van de toepassing, bijvoorbeeld draden met achtergrondtaken of aanvraagthreads (aanvraagthreads hebben namen als deze *127.0.0.1 1347028187737 GET /content/sites/global/en/sitemap.static-delivery.httpd.html HTTP/1.1*). Als u ze hebt gevonden, klikt u er een voor een op.

1. Voor elke verzoekdraad, kunt u te weten komen wanneer browser van de gebruiker het verzoek aan de server door timestamp in de draadnaam te bekijken maakte.  In de bovenstaande thread-naam is de tijdstempel (in milliseconde-tijdperknotatie) bijvoorbeeld 1347028187737.  We kunnen dat epochenummer omzetten in een datum/tijd met [www.epochconverter.com](http://www.epochconverter.com/).  Elke draadstortplaats toont de datum en de tijd toen het werd genomen.  U kunt het verschil in tijd tussen de verzoektijd en de tijd van de draadstortplaats nemen om te zien hoe lang een verzoek actief is geweest voor.

1. Na het herzien van de verzoekdraden, rol door de andere &quot;Runnable&quot;draden.  Wanneer u een &quot;Runnable&quot;draad van belang hebt gevonden, dan bekijk het middenpaneel, &quot;het Wachten draden&quot;.  De draden die daar worden vermeld wachten op de geselecteerde draad om een monitor vrij te geven.  Als u geen wachtende draden ziet, dan zou uw geselecteerde draad nog de eigenaar van a kunnen zijn [Vergrendelen](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) (zie het uitvoeren van klassen van [Vergrendelen](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/Lock.html) voor meer informatie). Met bijvoorbeeld een [ReentrantReadWriteLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html) u kunt niet zien welke draad de slothouder is aangezien de sloten veelvoudige monitors intern uitvoeren.  Zo zou u de broncode kunnen moeten bekijken om het met een draad aan te passen die de slothouder zou kunnen zijn.

1. Als de draad een slot had of monitor dat vele andere draden op dan wachtten ga door de rest draaddumps om te zien of kunt u andere draden vinden die de zelfde kwestie hebben.  Zie of bestaat de zelfde draad nog in de andere dumps (in IBM TDA kunt u veelvoudige draaddumps selecteren en de &quot;Compare knoop \* klikken om de staat van een draad over veelvoudige draaddumps te bekijken.

   ![tda-comparethreads](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1159496390/tda-comparethreads.png)

1. Zie de Collector Service in de onderstaande schermafbeelding:

   ![tda-Image2](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1730877898/tda-Image2.png)

1. In deze mening kunt u de draad over veelvoudige draaddumps zien om te zien of is het een lange lopende draad.  Basistatief als de draad in Runable staat over veelvoudige dumps is en een lange stapel toen heeft betekent dat gewoonlijk het een lange lopende draad is.

1. Als u niet veel het kijken naar de runnable draden toen ga terug naar de draadlijst, selecteer een draadstortplaats dan klik op &quot;de knoop van het Detail van de Monitor \* op het hoogste paneel. IBM TDA opent een venster dat een boomstructuurmening toont van monitor die draden en hun wachtende draden bezitten. Opmerking: Het zou sommige draden van de draadpool zoals de monitor van de de draaddraad van de servletmotor kunnen tonen, nutteloze draden zouden kunnen worden genegeerd.  U kunt gewoonlijk vertellen een draad een nutteloze draad van de draadpool is omdat het grootste deel van de tijd zij slechts 10 stapellijnen of minder hebben.

![tda-monitor](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/thread-dump-analysis/_jcr_content/main-pars/image_1106466084/tda-monitordetail.png)

<b>CPU-gebruik op Thread-niveau ([!DNL Linux] alleen platform):</b>

1. Als u &quot;top -H -b -n1 -p javapid&quot;output naast draaddumps registreerde, kunt u het gebruik van draad van cpu van het niveau van verwijzingen voorzien.  Open de bovenste uitvoer en ontvang de proces-id van de threads die de CPU gebruiken.  Zet procesidentiteitskaart in hexadecimaal dan onderzoek naar die hexadecimale waarde in het overeenkomstige dossier van de draadstortplaats om.  De id moet overeenkomen met de &quot;node&quot; van een van de threads.
1. Als de passende draad die de meeste cpu gebruikt de &quot;Draad van VM&quot;of om het even welke &quot;GC&quot;draden is, zou u een geheugenkwestie kunnen hebben.  Herhaal de zelfde oefening voor meer draaddumps en hoogste output en als er een patroon van deze draden die de tijd van cpu nemen is, hebt u een geheugenkwestie.
1. Als u het geheugenprobleem hebt bevestigd, legt u de volgende keer dat het probleem optreedt een heapdump vast.  Zie [dit artikel](https://helpx.adobe.com/experience-manager/kb/AnalyzeMemoryProblems.html) voor meer informatie over het vastleggen en analyseren van heapdumps.

![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)![](https://helpx.adobe.com/libs/cq/ui/resources/0.gif)

Threads die kunnen worden genegeerd:

- VM-thread: Dit is een VM-systeemthread.
- Threads die beginnen met GC-taakthread: Dit zijn vuilnisthreads.
- Threads met namen vergelijkbaar met - 1347028691218 in code op java.net.PlainSocketImpl.socketAccept(Native Methode): Dit zijn draden van de de draadpool van de servlet motor die op nieuwe verbindingen wachten.
