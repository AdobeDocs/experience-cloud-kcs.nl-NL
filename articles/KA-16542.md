---
title: "Oplossing van inconsistenties in de repository wanneer SegmentNotFound Issue wordt gerapporteerd in AEM 6.x"
description: Beschrijving
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS"
resolution: Resolution
internal-notes: "Helpx Link: https://helpx.adobe.com/experience-manager/kb/fix-inconsistencies-in-the-repository-when-segmentnotfound-issue.html"
bug: false
article-created-by: Emily Geary
article-created-date: "4/12/2021 6:11:55 PM"
article-published-by: Emily Geary
article-published-date: "4/12/2021 6:12:16 PM"
version-number: 6
article-number: KA-16542
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=18318d8e-ba9b-eb11-b1ac-000d3a3680d8"
exl-id: b9b98c01-bc0b-4384-bc5d-67a6eb899ec4
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '276'
ht-degree: 1%

---

# Oplossing van inconsistenties in de repository wanneer SegmentNotFound Issue wordt gerapporteerd in AEM 6.x

## Beschrijving


Observed SegmentNotFound-uitzonderingen in de logboeken. Bijvoorbeeld:

1. \*ERROR\* FelixStartLevel org.apache.sling.event org.apache.sling.event.impl.jobs.queueManager(1431) De activeringsmethode heeft een uitzondering gegenereerd (org.apache.jackrabbit.oak.plugins.segment.SegmentNotFoundException: Segment da5bcb95-d00a-4c04-a9d9-0f10f2b14e5e niet gevonden)
2. \*ERROR \* pool-6-draad-3 org.apache.sling.commons.planner.impl.QuartzScheduler Uitzondering tijdens baanuitvoering van org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdate@1dc173f9: Segment e669f30b-e886-4b7a-b161-56432601ec6b niet gevonden

   org.apache.jackrabbit.oak.plugins.segment.SegmentNotFoundException: Segment e669f30b-e886-4b7a-b161-56432601ec6b niet gevonden


<b>Omgeving</b>

AEM 6.\*

<b>Oorzaak</b>

Als gevolg van sommige oudere problemen in Oak of enkele inconsistenties in de repository kan een segment ontbreken en is de repository mogelijk inconsistent.


## Resolutie


Voer consistentiecontrole uit op de opslagplaats en zoek de laatste goede revisie naar een gezonde staat en herstel deze. Voer de volgende handelingen uit:

1. Download een versie van een eak-run die overeenkomt met uw eak-kernversie vanÂ [https://mvnrepository.com/artifact/org.apache.jackrabbit/oak-run](https://mvnrepository.com/artifact/org.apache.jackrabbit/oak-run)
2. Om een corrupte segmentopslag terug te keren naar zijn recentste goede staatsverandering in de het werkfolder van CQ (die crx-quickstartfolder bevat) en steun alle dossiers in./crx-quickstart/repository/segmentstore/.
3. Voer de consistentiecontrole uit,

   <b>`java -Xmx6000m -jar oak-run-*.jar check --bin=-1 /path/to/crx-quickstart/repository/segmentstore`</b>



   Dit doorzoekt achterwaarts door de revisies tot het verenigbare vindt:



   Kijk hieronder naar berichten:

   main INFO o.a.j.o.p.s.f.t.ConsistencyChecker - Nieuwste goede revisie gevonden fdb922d-ba53-4a1b-aa1b-1cb044b535cf:234880


4. Herstel de repository naar deze revisie door te bewerken./crx-quickstart/repository/segmentstore/journal.log en alle regels verwijderen na de regel met de laatste goede revisie.
5. Alles verwijderen./crx-quickstart/repository/segmentstore/\*.bak-bestanden.
6. Opschonen van controlepunten uitvoeren om zwevende controlepunten te verwijderen:

   <b>`java -Xmx6000m -jar oak-run-*.jar checkpoints /path/to/crx-quickstart/repository/segmentstore rm-unreferenced`</b>


7. Tot slot comprimeer de repository:

   <b>`java -Xmx6000m -jar oak-run-*.jar compact /path/to/crx-quickstart/repository/segmentstore/`</b>&#x200B;&#x200B;&#x200B;&#x200B;&#x200B;&#x200B;&#x200B;
