---
title: Hoe te om een datastore consistentiecontrole via eiken-looppas in werking te stellen
description: Beschrijving
solution: Experience Manager
product: Experience Manager
applies-to: Experience Manager
keywords: KCS
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Akash Kapoor
article-created-date: 4/3/2022 9:37:38 PM
article-published-by: Akash Kapoor
article-published-date: 4/3/2022 9:39:46 PM
version-number: 2
article-number: KA-19064
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=68a58547-96b3-ec11-983f-000d3a5d09d6
exl-id: 8aec0830-a1db-4e57-95e4-3745e87bde32
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '392'
ht-degree: 0%

---

# Hoe te om een datastore consistentiecontrole via eiken-looppas in werking te stellen

## Beschrijving

De controle van de consistentie van de gegevensopslag zal om het even welke binaire getallen van de gegevensopslag melden die missen maar nog van verwijzingen voorzien zijn. De consistentiecontrole kan direct door de console van Felix worden teweeggebracht.<br>
Het kon van MarkSweepGarbageCollector#checkConsistency Mobean worden teweeggebracht

Als het BlobGC MBeans in MBeanServer wordt geregistreerd dan kan het volgende gebied ook worden gebruikt:

BlobGCMbean#checkConsistency

Nadat de consistentiecontrole is voltooid, wordt een bericht weergegeven met het aantal binaire getallen dat als ontbrekend wordt gerapporteerd. Als het aantal groter is dan 0, controleer de logboeken die voor org.apache.jackrabbit.oak.plugins.blob.MarkSweepGarbageCollector worden gevormd voor meer details op de ontbrekende binaire getallen.

Hieronder ziet u een voorbeeld van de manier waarop de ontbrekende binaire bestanden worden gerapporteerd in de logboeken:

`11:32:39.673 INFO main MarkSweepGarbageCollector.java:600 Consistency check found 1 missing blobs 11:32:39.673 WARN main MarkSweepGarbageCollector.java:602 Consistency check failure in the the blob store : DataStore backed BlobStore org.apache.jackrabbit.oak.plugins.blob.datastore.OakFileDataStore, check missing candidates in file /tmp/gcworkdir-1467352959243/gccand-1467352959243`

In tegenstelling tot /system/console/repositorycheck UI, controleert het eiken-in werking gestelde hulpmiddel de verborgen dossiers van de lucene index onder /oak: index naast de rest van de inhoudspaden. &quot;datastorecheck&quot;, opdracht van <b>eik </b>kan worden gebruikt om een consistentiecontrole op de datastore uit te voeren.  De gedetailleerde stappen voor het uitvoeren van het bevel worden hieronder beschreven:




## Resolutie


1. Download de jar 1.8.8 of hoger-versie van de eak aan uw AEM server.
2. Plaats de eiken looppas jar in de zelfde folder waar crx-quickstart wordt geplaatst anders verstrekt de volledige weg van eiken-looppas \*.jar terwijl het lopen onder bevel.
3. Voer de onderstaande opdracht uit (werk de paden naar de segmentstore en datastore bij volgens uw omgeving):


`java -jar oak-run-*.jar datastorecheck --consistency --ref --id --fds crx-quickstart/install/org.apache.jackrabbit.oak.plugins.blob.datastore.FileDataStore.config --repoHome crx-quickstart/repository --store crx-quickstart/repository/segmentstore --dump temp --verbose --track`

4. Het bevel zou een datastore consistentiecontrole uitvoeren.

De controle van de consistentie voor DataStore kan ook worden gebruikt om van alle blob verwijzingen in de knoopopslag en alle blob ids een lijst te maken beschikbaar in de gegevensopslag. Gebruik de volgende opdracht:

`$ java-jar oak-run-*.jar datastorecheck --id --ref --consistency \`

`--store | \`

`--s3ds |--fds \`

`--dump \`

`--track`



Geef een of meer van de volgende opties op:

—id - Alle id&#39;s in de gegevensopslag weergeven.

—ref - maak een lijst van alle blob verwijzingen in de knoopopslag.

—Consistentie - Alle ontbrekende klokken weergeven door een consistentiecontrole uit te voeren.



De volgende opties zijn optioneel:

—store - Path to the segment store of mongo uri (Required for —ref and —Consistentie options above).

—dump - Pad waar de bestanden moeten worden gestort (optioneel). Anders worden bestanden gedumpt in de tmp-directory van de gebruiker.

—s3ds - Weg aan het S3DataStore configuratiedossier.

—fds - Pad naar het configuratiebestand FileDataStore (eigenschap &#39;path&#39; is verplicht).

—track - Pad van de thuismap van de lokale opslagruimte (optioneel). Er wordt een kopie geplaatst van de gedownloade blob-id die moet worden bijgehouden.
