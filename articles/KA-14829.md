---
title: Campaign Classic V7 - Wat is db module pg_stat_statements? Waarvoor is het bedoeld?
description: Beschrijving
solution: Campaign,Campaign Classic v7
product: Campaign,Campaign Classic v7
applies-to: Campaign Classic,Campaign,Campaign Classic v7
keywords: KCS
resolution: Resolution
internal-notes: https://wiki.corp.adobe.com/pages/viewpage.action?spaceKey=neolane&title=Database+performance+optimization+-+Identify+bottleneck+queries+with+execution+statistics#Databaseperformanceoptimization-Identifybottleneckquerieswithexecutionstatistics-pg_stat_statements
bug: false
article-created-by: Marta Zator
article-created-date: 5/4/2022 4:36:53 PM
article-published-by: Marta Zator
article-published-date: 5/4/2022 4:38:25 PM
version-number: 2
article-number: KA-14829
dynamics-url: https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=aa74c765-c8cb-ec11-a7b5-6045bd00d4f5
exl-id: ad0f34e4-bf33-4eef-a290-7b0a3e92a6c9
source-git-commit: e8f4ca2dd578944d4fe399074fab461de88ad247
workflow-type: tm+mt
source-wordcount: '350'
ht-degree: 1%

---

# Campaign Classic V7 - Wat is db module pg_stat_statements? Waarvoor is het bedoeld?

## Beschrijving


1. Wat is db module pg_stat_statements?

2. Waarom wordt het gevraagd om door cliënten toe te laten?

3. Hoe wordt het geactiveerd?






## Resolutie




1.  De pg_stat_statements module verstrekt een middel om uitvoeringsstatistieken van alle SQL verklaringen te volgen die door een server worden uitgevoerd.

De module moet worden geladen door pg_stat_statements toe te voegen aan shared_preload_libraries in postgresql.conf, omdat er extra gedeeld geheugen voor nodig is. Dit betekent dat een server opnieuw moet worden opgestart om de module toe te voegen of te verwijderen.

Koppeling: [https://www.postgresql.org/docs/9.4/pgstatstatements.html](https://www.postgresql.org/docs/9.4/pgstatstatements.html)



2. Om een meningstype schema op deze lijst uit te voeren die ons toestaat om vragen te controleren die lange tijd vergen. Op deze manier kunnen clients deze instellingen aanpassen en de prestaties optimaliseren.

Deze extensie biedt metriek bij het uitvoeren van query&#39;s: die de vaakst in werking gestelde vragen zijn en hoe lang elk neemt.



3.  <b>pg_stat_statements </b>

1. Controleer of het officiële PostSQL-programmapakket voor de postversie is geïnstalleerd.

$ dpkg -l | grep postgres postgresql-contrib-9,3

Installeer de toepassing als deze niet is geïnstalleerd.

$ apt-get install postgresql-contrib-9,3

2. Postgresql.conf wijzigen om de module bij het opstarten vooraf te laden

Standaard: shared_preload_libraries = &#39;&#39; New : shared_preload_libraries = &#39;pg_stat_statements&#39; — als zowel pg_stat_statements als auto_justification worden gebruikt, gebruik ONE-record en maak gescheiden met komma&#39;s shared_preload_libraries = &#39;auto_justification,pg_stat_statements&#39;

3. Voer in de database die u wilt controleren, de CREATE-query uit:

— er is geen extensieverwezenlijking vereist voor auto_justification, alleen voor pg_stat_statements psql postgres=# \c mydatabase mydatabase=# CREATE EXTENSION pg_stat_statements;

4. Voeg de regels toe in het gedeelte AANGEPASTE OPTIONS van postgresql.conf:

pg_stat_statements.max = 5000 pg_stat_statements.track = all pg_stat_statements.save = on

5. Voorbeeld van postgressieve service opnieuw starten: Krijg top 5 duurste vragen in de gegevensbestanden

SELECT query, call, total_time, rows, 100.0\*shared_blks_hit/nullif(shared_blks_hit+shared_blks_read,0) AS hit_percent van pg_stat_statements as s inner join pg_database as d on d.oid = s.dbid where d.datname = &#39;Database_Name&#39; order by total_time desc 5;
